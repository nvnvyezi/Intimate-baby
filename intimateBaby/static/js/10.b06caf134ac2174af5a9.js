webpackJsonp([10],{GiJC:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("P9l9"),n={name:"bookChapter",props:{color:{type:String,required:!0,default:"#D5EFD2"},sizeFont:{type:Number,required:!0,default:2}},data:function(){return{chapterName:"",startX:0,startY:0,flag:500}},computed:{page:{get:function(){var t=this.$store.state.bookInfo.page;return t||(t=localStorage.getItem("chapterPage"),this.$store.dispatch({type:"triggerPage",page:t})),t},set:function(t){console.log(t),this.$store.dispatch({type:"triggerPage",page:t}),localStorage.setItem("chapterPage",t)}},bookName:function(){var t=this.$store.state.bookInfo.bookName;return t||(t=localStorage.getItem("bookName")),t},authorName:function(){var t=this.$store.state.bookInfo.authorName;return t||(t=localStorage.getItem("authorName")),t}},mounted:function(){this.getChapter()},methods:{test:function(t){t.stopPropagation();var e=document.documentElement.offsetWidth,a=t.clientX;t.target===t.currentTarget.firstChild&&a<=100?this.page>0?this.page--:(this.$emit("showWrong","当前已经是第一章"),this.page=0):t.target!=t.currentTarget.firstChild&&a<=100&&(t.target.nextSibling&&t.target.nextSibling.nextSibling&&(t.target.nextSibling.nextSibling.style.display="none"),t.target.previousSibling.style.transform="translate(0px, 0px)",t.target.previousSibling.style.display="block"),t.target===t.currentTarget.lastChild&&a>=e/2+60?this.page<localStorage.getItem("chapterSize")?this.page++:(this.$emit("showWrong","当前已经是最后一章"),this.page=localStorage.getItem("chapterSize")):t.target!=t.currentTarget.lastChild&&a>=e/2+60&&(t.target.previousSibling&&t.target.previousSibling.previousSibling&&(t.target.previousSibling.previousSibling.style.display="none"),t.target.style.transform="translate("+-e+"px, 0px)",t.target.nextSibling.style.display="block")},getChapter:function(){var t=this;Object(r.j)(this.bookName,this.authorName,this.page,function(e){t.chapterName=e.chapter,t.$emit("changeCatelog",t.chapterName),t.handleText(e.text)})},handleText:function(t){var e=document.getElementsByClassName("chapter")[0],a=document.getElementsByClassName("chapter--content")[0],r=document.createElement("div"),n=document.documentElement.offsetHeight||document.body.offsetHeight;a.style.zIndex=this.flag,a.style.backgroundColor="#"+this.color,this.flag--,e.appendChild(r);for(var i=0,o=t.length;i<o;i++){if(r.innerHTML=t.substring(0,i),!(r.offsetHeight<=n-50)){e.removeChild(r),this.handleTextOver(t,i-1,o,n);break}a.innerHTML=t.substring(0,i),i==o-1&&e.removeChild(r)}},handleTextOver:function(t,e,a,r){var n=document.createElement("div"),i=document.getElementsByClassName("chapter")[0];n.setAttribute("data-flag",this.flag),n.style.zIndex=this.flag,n.style.position="absolute",n.style.width="95vw",n.style.left="50%",n.style.marginLeft="-47.5vw",n.style.backgroundColor="#"+this.color,n.style.transition="transform .5s ease",n.className="chapter--content",this.flag--,i.appendChild(n);for(var o=e;o<a;o++){if(n.innerHTML=t.substring(e,o),!(n.offsetHeight<=r-10)){n.innerHTML=t.substring(e,o-1),n.style.height=r+"px",this.handleTextOver(t,o-1,a,r);break}o==a-1&&(n.style.height=r+"px")}}},watch:{page:function(){location.reload(),this.getChapter()},color:function(t){var e=document.getElementsByClassName("chapter"),a=document.getElementsByClassName("chapter--content");e[0].style.backgroundColor="#"+this.color;for(var r=0;r<a.length;r++)a[r].style.backgroundColor="#"+this.color}}},i={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"chapterBox",style:{fontSize:this.sizeFont+"rem"}},[e("div",{staticClass:"chapter",on:{click:this.test}},[e("div",{staticClass:"chapter--content"})])])},staticRenderFns:[]};var o=a("VU/8")(n,i,!1,function(t){a("KR0y")},"data-v-766c2c63",null);e.default=o.exports},KR0y:function(t,e){}});
//# sourceMappingURL=10.b06caf134ac2174af5a9.js.map